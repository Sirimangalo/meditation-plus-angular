<!-- title/logo -->
<div class="logo"></div>
<md-card>
  <md-card-title>Video Wiki</md-card-title>
  <md-card-subtitle>Welcome to Sirimangalo International's interactive video archive!</md-card-subtitle>

  <!-- 'add video' button -->
  <button md-fab [routerLink]="['/wiki/new']">
    <md-icon md-prefix>add</md-icon>
  </button>

  <!-- search bar -->
  <div>
    <form [formGroup]="form">
      <div class="search">
        <md-icon md-prefix>search</md-icon>
        <md-input
          [(ngModel)]="currentSearch"
          type="text"
          name="search"
          placeholder="search all videos"
          formControlName="search"
        >
        </md-input>
      </div>
    </form>
  </div>

  <!-- search results -->
  <div *ngIf="currentSearch">
    <h4 class="btn heading"><span>search results</span></h4>
    <div class="content">
      <md-list *ngIf="searchResults && searchResults.length">
        <wiki-list-entry
            *ngFor="let video of searchResults"
            (update)="loadVideos()"
            [video]="video"
            [admin]="admin"></wiki-list-entry>
      </md-list>
      <span *ngIf="!searchResults || !searchResults.length">no videos found</span>
    </div>
  </div>

  <!-- categories/topics -->
  <div *ngIf="!currentSearch">
    <h4 class="btn heading" (click)="showCategory = !showCategory">
      <md-icon class="arrow">{{ showCategory ? 'keyboard_arrow_down' : 'keyboard_arrow_right' }}</md-icon>
      <span>select topic</span>
      <span *ngIf="selectedCategory" class="selectedCategory"> ({{ selectedCategory }})</span>
    </h4>
    <div class="content" [hidden]="!showCategory">
      <md-spinner *ngIf="!structure" class="load-more-spinner"></md-spinner>
      <ul>
        <li *ngFor="let cat of structure"
            (click)="changeCategory(cat.name)"
            [class.selected]="cat.name === selectedCategory"
            class="btn"
        >
          {{ cat.name }} ({{ cat.count }})
        </li>
      </ul>
    </div>
    <md-divider></md-divider>
  </div>


  <!-- tags -->
  <div *ngIf="!currentSearch">
    <h4 class="btn heading" (click)="showTags = !showTags">
      <md-icon class="arrow">{{ showTags ? 'keyboard_arrow_down' : 'keyboard_arrow_right' }}</md-icon>
      <span>select tags</span>
    </h4>
    <div class="content" [hidden]="!showTags">
      <div *ngIf="selectedCategory && structure">
        <md-icon title="show all" class="noselect pointer" (click)="toggleAllTags(true)">check_circle</md-icon>
        <md-icon title="hide all" class="noselect pointer" (click)="toggleAllTags(false)">highlight_off</md-icon>
        <div *ngFor="let cat of structure" [hidden]="selectedCategory !== cat.name">
          <span *ngFor="let tag of cat.tags" class="tag noselect" [class.active]="selectedTags[tag]" (click)="toggleTag($event, tag)">{{ tag }}</span>
        </div>
      </div>
      <span *ngIf="!selectedCategory">no category selected</span>
    </div>
    <md-divider></md-divider>
  </div>


  <!-- selected videos -->
  <div *ngIf="!currentSearch">
    <h4 class="btn heading" (click)="showVideos = !showVideos">
      <md-icon class="arrow">{{ showVideos ? 'keyboard_arrow_down' : 'keyboard_arrow_right' }}</md-icon>
      <span>select video</span>
    </h4>
    <div class="content" [hidden]="!showVideos">
      <md-list *ngIf="selectedVideos">
        <wiki-list-entry
            *ngFor="let video of selectedVideos"
            (update)="loadVideos()"
            [video]="video"
            [admin]="admin"></wiki-list-entry>
      </md-list>
      <span *ngIf="!selectedTags">no tags selected</span>
    </div>
  </div>
  <div *ngIf="count" class="count">Total Videos: {{ count }}</div>
</md-card>
